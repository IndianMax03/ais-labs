# Методы машинного обучения

## Лабораторная работа 1. Метод линейной регрессии

### Введение

#### Цель работы

Реализация метода линейной регрессии

#### Задачи работы

- Получение и визуализация статистики по датасету
- Проведение предварительной обработки данных
- Разделение данных на обучающую и тестовую выборки
- Реализация метода линейной регрессии с использованием метода МНК без использования сторонних библиотек (кроме NumPy и Pandas)
- Построение 3-х моделей с различными наборами признаков
- Проведение оценки производительности (коэффициент детерминации)
- Выводы о наилучшей совокупности признаков
- Бонусное задание: введение синтетического признака

### Описание метода

Метод линейной регрессии - это статистический метод, используемый для анализа связи между зависимой переменной и одной или несколькими независимыми переменными. Его основное назначение заключается в предсказании значений зависимой переменной на основе значений независимых переменных.

Принцип работы метода линейной регрессии заключается в поиске линейной зависимости между переменными. Для этого строится уравнение линейной регрессии, которое представляет собой прямую линию, наилучшим образом соответствующую распределению точек на графике. Далее, используя это уравнение, можно предсказать значения зависимой переменной для новых значений независимых переменных.

### Псевдокод метода

Ниже представлен код обучения модели на тренировочных данных

```python
n = len(X_train_matrix)
width = len(X_train_matrix[0])
A = []
B = []

# B:
B.append(sum(Y_train_matrix))
for i in range(width):
  B.append(sum(Y_train_matrix * X_train_matrix[:, i]))

# A:

A.append([])
tmp = A[0]
tmp.append(n)
for i in range(width):
  tmp.append(sum(X_train_matrix[:, i]))

for i in range(width):
  A.append([])
  tmp = A[i+1]
  tmp.append(sum(X_train_matrix[:, i]))
  for j in range(width):
    tmp.append(sum(X_train_matrix[:, i] * X_train_matrix[:, j]))

solution = np.linalg.solve(A, B)
```

### Результаты выполнения

В качестве результата работы метода получаем вектор коэффициентов, который в дальнейшем используем для предсказания на тестовых данных:

```python
scalar_method_prediction = np.dot(X_test_matrix, solution)
```

### Примеры использования метода

#### Ограничения

- Линейная зависимость меджу данными
- Отсутствие большого количества выбросов
- Отсутствие мультиколлинеарности (в модели отсутствуют коррелирующие между собой переменные)

#### Тесткейсы

- Экономика: анализ зависимости между уровнем дохода, районом проживания, ... и *расходами на потребительские товары*
- Социология: анализ влияния образования, семейного положения, ... и *дохода на уровень счастья людей*
- Биология: анализ зависимости между количеством употребляемых калорий, подвижностью, ... и *изменением веса организма*
- и проч.

## Лабораторная работа 2. Метод k-ближайших соседей (k-NN)

### Введение

#### Цель работы

Реализация метода k-ближайших соседей

#### Задачи работы

- Проведение предварительной обработки данных
- Реализация метода k-ближайших соседей без использования сторонних библиотек (кроме NumPy и Pandas)
- Построение двух моделей k-NN с различными наборами признаков
    - Модель 1: Признаки отбираются случайно.
    - Модель 2: Фиксированный набор признаков, который выбирается заранее.
- Оценка моделей при разных значениях k, построение матрицы ошибок.

### Описание метода

Метод k-ближайших соседей (k-nearest neighbors) - это метод машинного обучения, который используется для классификации и регрессии. Его основное назначение - предсказание значения целевой переменной на основе значений ближайших к ней соседей в пространстве признаков.

Принцип работы метода заключается в том, что для нового объекта предсказывается значение целевой переменной на основе значений этой переменной у k ближайших к нему соседей. Для классификации выбирается наиболее часто встречающийся класс среди соседей, а для регрессии - вычисляется среднее или медианное значение целевой переменной среди соседей.

### Псевдокод метода

#### Расчет Евклидова расстояния между объектами

```python
def euclidean_distance(X_1, X_2):
  distance = 0
  for i in range (len(X_1)):
    distance += (X_1[i] - X_2[i]) ** 2
  return math.sqrt(distance)
```

#### Поиск k ближайших соседей

```python
def get_neighbors(X_train, Y_train, X_test_values, k):
  X_train_values = X_train.values
  Y_train_values = Y_train.values
  distances = []
  for i in range (len(X_train_values)):
    distances.append((Y_train_values[i], euclidean_distance(X_train_values[i], X_test_values)))

  distances.sort(key=lambda elem: elem[1])

  neighbors = []
  for i in range(k):
    neighbors.append(distances[i][0])

  return neighbors
```

### Результаты выполнения

В результате работы обучения мы получаем модель, предсказывающую класс объекта на основе его признаков.

#### Предсказание класса

```python
def predict_class(neighbors):
  counter = {}

  for neighbor in neighbors:
    if neighbor in counter:
        counter[neighbor] += 1
    else:
        counter[neighbor] = 1

  max_count = max(counter.values())
  return [key for key, value in counter.items() if value == max_count][0]
```

### Примеры использования метода

#### Ограничения

- Большая, разнообразная выборка для эффективной работы
- Чувствителен к выбору признаков
- Выская вычислительная сложность: O(n^2)
- Проклятие размерности (чем больше признаков, тем менее различимы классы)
- Выбор значения k может существенно влиять на результаты классификации

#### Тесткейсы

- В экономике: анализ кредитного скоринга (можно ли доверить выдачу кредита заемщику)
- В медицине: диагностика болезней на основе симптомов и проч.
- Обработка естественного языка: спам для почты, отзывы для товаров (на основе слов определяем положительный или отрицательный)
- и прочие задачи классификации


## Лабораторная работа 3. Деревья решений

### Введение

[Введение в тему лабораторной работы, описание задачи и целей.]

### Описание метода

[Краткое описание метода деревьев решений, его назначения и принципа работы.]

### Псевдокод метода

```css
[Здесь представлен псевдокод алгоритма метода деревьев решений.]

```

### Результаты выполнения

[Опишите полученные результаты после применения метода деревьев решений. Можете включить графики, численные значения и примеры.]

### Примеры использования метода

[Приведите примеры ситуаций, когда метод деревьев решений может быть полезен. Объясните, почему именно этот метод выбран.]

## Лабораторная работа 4. Логистическая регрессия

### Введение

[Описание задачи и целей.]

### Описание метода

[Краткое описание метода логистической регрессии, его назначения и принципа работы.]

### Псевдокод метода

```css
[Здесь представлен псевдокод алгоритма метода логистической регрессии.]

```

### Результаты выполнения

[Опишите полученные результаты после применения метода логистической регрессии. Можете включить графики, численные значения и примеры.]

### Примеры использования метода

[Приведите примеры ситуаций, когда метод логистической регрессии может быть полезен. Объясните, почему именно этот метод выбран.]

## Сравнение методов

### Сравнительный анализ методов

[Произведите сравнительный анализ результатов и производительности каждого метода. Опишите их преимущества и ограничения.]

### Примеры лучшего использования каждого метода

[Укажите, в каких ситуациях каждый из методов наиболее эффективен и почему.]

## Заключение

[Окончательные выводы и обобщение результатов.]

## Приложения

[Код]
